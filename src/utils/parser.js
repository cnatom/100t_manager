import {Tag} from "antd";
import {keyMap} from "./keyMap";
let jsonList = {
    "alarm_rules": {
        "bgdl1": [
            -1,
            -1
        ],
        "bgdl2": [
            -1,
            -1
        ],
        "bgdl3": [
            -1,
            -1
        ],
        "bgdl4": [
            -1,
            -1
        ],
        "bgdl5": [
            -1,
            -1
        ],
        "bgdl6": [
            -1,
            -1
        ],
        "dqsl": [
            -1,
            -1
        ],
        "dqwd": [
            1,
            -1
        ],
        "lcdl": [
            -1,
            -1
        ],
        "lcdy": [
            -1,
            -1
        ],
        "scdl": [
            -1,
            -1
        ],
        "scdy": [
            -12,
            100
        ],
        "slcsl": [
            -1,
            -1
        ],
        "slcwd": [
            -1,
            -1
        ],
        "sxwd": [
            -1,
            -1
        ],
        "xlcsl": [
            -1,
            -1
        ],
        "xlcwd": [
            -1,
            -1
        ]
    },
    "data_history": [
        {
            "data": {
                "bgdl1": "9.0",
                "bgdl2": "10.8",
                "bgdl3": "11.9",
                "bgdl4": "10.0",
                "bgdl5": "9.9",
                "bgdl6": "10.0",
                "bgdl7": 0,
                "bgdl8": 0,
                "bgdl9": 0,
                "d1wd": 0,
                "d2wd": 0,
                "d3wd": 0,
                "d4wd": 0,
                "dqsl": "9.8",
                "dqwd": "6.5",
                "gzbj": 0,
                "lcdl": "46.9",
                "lcdy": "30.9",
                "scdl": "62.0",
                "scdy": "11.4",
                "slcsl": "4.8",
                "slcwd": "5.5",
                "sn": 0,
                "sxwd": "2.3",
                "xlcsl": "5.4",
                "xlcwd": "5.5",
                "yxsj": "0天 0小时 23分钟 49秒"
            },
            "update_time": "2024-05-19 16:20:40"
        },
        {
            "data": {
                "bgdl1": "9.5",
                "bgdl2": "10.2",
                "bgdl3": "11.3",
                "bgdl4": "10.0",
                "bgdl5": "9.9",
                "bgdl6": "10.0",
                "bgdl7": 0,
                "bgdl8": 0,
                "bgdl9": 0,
                "d1wd": 0,
                "d2wd": 0,
                "d3wd": 0,
                "d4wd": 0,
                "dqsl": "10.4",
                "dqwd": "6.5",
                "gzbj": 0,
                "lcdl": "47.6",
                "lcdy": "34.7",
                "scdl": "60.6",
                "scdy": "11.0",
                "slcsl": "5.3",
                "slcwd": "5.5",
                "sn": 0,
                "sxwd": "2.3",
                "xlcsl": "5.4",
                "xlcwd": "5.5",
                "yxsj": "0天 0小时 23分钟 48秒"
            },
            "update_time": "2024-05-19 16:20:39"
        },
        {
            "data": {
                "bgdl1": "10.6",
                "bgdl2": "9.9",
                "bgdl3": "10.1",
                "bgdl4": "10.0",
                "bgdl5": "9.9",
                "bgdl6": "10.0",
                "bgdl7": 0,
                "bgdl8": 0,
                "bgdl9": 0,
                "d1wd": 0,
                "d2wd": 0,
                "d3wd": 0,
                "d4wd": 0,
                "dqsl": "10.4",
                "dqwd": "6.5",
                "gzbj": 0,
                "lcdl": "47.6",
                "lcdy": "34.7",
                "scdl": "60.6",
                "scdy": "11.0",
                "slcsl": "4.9",
                "slcwd": "5.5",
                "sn": 0,
                "sxwd": "2.3",
                "xlcsl": "5.3",
                "xlcwd": "5.5",
                "yxsj": "0天 0小时 23分钟 47秒"
            },
            "update_time": "2024-05-19 16:20:38"
        },
        {
            "data": {
                "bgdl1": "9.2",
                "bgdl2": "9.5",
                "bgdl3": "11.8",
                "bgdl4": "10.0",
                "bgdl5": "9.9",
                "bgdl6": "10.0",
                "bgdl7": 0,
                "bgdl8": 0,
                "bgdl9": 0,
                "d1wd": 0,
                "d2wd": 0,
                "d3wd": 0,
                "d4wd": 0,
                "dqsl": "10.4",
                "dqwd": "6.5",
                "gzbj": 0,
                "lcdl": "47.6",
                "lcdy": "34.7",
                "scdl": "58.2",
                "scdy": "11.6",
                "slcsl": "4.8",
                "slcwd": "5.5",
                "sn": 0,
                "sxwd": "2.3",
                "xlcsl": "5.3",
                "xlcwd": "5.5",
                "yxsj": "0天 0小时 23分钟 46秒"
            },
            "update_time": "2024-05-19 16:20:37"
        },
        {
            "data": {
                "bgdl1": "9.8",
                "bgdl2": "9.7",
                "bgdl3": "10.3",
                "bgdl4": "10.0",
                "bgdl5": "9.9",
                "bgdl6": "10.0",
                "bgdl7": 0,
                "bgdl8": 0,
                "bgdl9": 0,
                "d1wd": 0,
                "d2wd": 0,
                "d3wd": 0,
                "d4wd": 0,
                "dqsl": "10.4",
                "dqwd": "6.5",
                "gzbj": 0,
                "lcdl": "47.6",
                "lcdy": "34.7",
                "scdl": "58.2",
                "scdy": "11.6",
                "slcsl": "4.9",
                "slcwd": "5.5",
                "sn": 0,
                "sxwd": "2.3",
                "xlcsl": "5.3",
                "xlcwd": "5.5",
                "yxsj": "0天 0小时 23分钟 45秒"
            },
            "update_time": "2024-05-19 16:20:36"
        },
        {
            "data": {
                "bgdl1": "9.2",
                "bgdl2": "10.7",
                "bgdl3": "11.0",
                "bgdl4": "10.0",
                "bgdl5": "9.9",
                "bgdl6": "10.0",
                "bgdl7": 0,
                "bgdl8": 0,
                "bgdl9": 0,
                "d1wd": 0,
                "d2wd": 0,
                "d3wd": 0,
                "d4wd": 0,
                "dqsl": "10.3",
                "dqwd": "6.5",
                "gzbj": 0,
                "lcdl": "47.6",
                "lcdy": "34.7",
                "scdl": "62.8",
                "scdy": "12.5",
                "slcsl": "4.8",
                "slcwd": "5.5",
                "sn": 0,
                "sxwd": "2.3",
                "xlcsl": "4.9",
                "xlcwd": "5.5",
                "yxsj": "0天 0小时 23分钟 44秒"
            },
            "update_time": "2024-05-19 16:20:35"
        },
        {
            "data": {
                "bgdl1": "10.2",
                "bgdl2": "10.8",
                "bgdl3": "9.7",
                "bgdl4": "10.0",
                "bgdl5": "9.9",
                "bgdl6": "10.0",
                "bgdl7": 0,
                "bgdl8": 0,
                "bgdl9": 0,
                "d1wd": 0,
                "d2wd": 0,
                "d3wd": 0,
                "d4wd": 0,
                "dqsl": "10.3",
                "dqwd": "6.5",
                "gzbj": 0,
                "lcdl": "47.6",
                "lcdy": "34.7",
                "scdl": "62.8",
                "scdy": "12.5",
                "slcsl": "5.0",
                "slcwd": "5.5",
                "sn": 0,
                "sxwd": "2.3",
                "xlcsl": "4.9",
                "xlcwd": "5.5",
                "yxsj": "0天 0小时 23分钟 43秒"
            },
            "update_time": "2024-05-19 16:20:34"
        },
        {
            "data": {
                "bgdl1": "9.8",
                "bgdl2": "10.4",
                "bgdl3": "11.0",
                "bgdl4": "10.0",
                "bgdl5": "9.9",
                "bgdl6": "10.0",
                "bgdl7": 0,
                "bgdl8": 0,
                "bgdl9": 0,
                "d1wd": 0,
                "d2wd": 0,
                "d3wd": 0,
                "d4wd": 0,
                "dqsl": "10.4",
                "dqwd": "6.5",
                "gzbj": 0,
                "lcdl": "47.6",
                "lcdy": "34.7",
                "scdl": "62.5",
                "scdy": "11.8",
                "slcsl": "5.2",
                "slcwd": "5.5",
                "sn": 0,
                "sxwd": "2.3",
                "xlcsl": "4.9",
                "xlcwd": "5.5",
                "yxsj": "0天 0小时 23分钟 42秒"
            },
            "update_time": "2024-05-19 16:20:33"
        },
        {
            "data": {
                "bgdl1": "9.7",
                "bgdl2": "10.4",
                "bgdl3": "10.1",
                "bgdl4": "10.0",
                "bgdl5": "9.9",
                "bgdl6": "10.0",
                "bgdl7": 0,
                "bgdl8": 0,
                "bgdl9": 0,
                "d1wd": 0,
                "d2wd": 0,
                "d3wd": 0,
                "d4wd": 0,
                "dqsl": "10.4",
                "dqwd": "6.5",
                "gzbj": 0,
                "lcdl": "47.6",
                "lcdy": "34.7",
                "scdl": "62.5",
                "scdy": "11.8",
                "slcsl": "5.1",
                "slcwd": "5.5",
                "sn": 0,
                "sxwd": "2.3",
                "xlcsl": "4.8",
                "xlcwd": "5.5",
                "yxsj": "0天 0小时 23分钟 41秒"
            },
            "update_time": "2024-05-19 16:20:32"
        },
        {
            "data": {
                "bgdl1": "9.2",
                "bgdl2": "9.7",
                "bgdl3": "11.2",
                "bgdl4": "10.0",
                "bgdl5": "9.9",
                "bgdl6": "10.0",
                "bgdl7": 0,
                "bgdl8": 0,
                "bgdl9": 0,
                "d1wd": 0,
                "d2wd": 0,
                "d3wd": 0,
                "d4wd": 0,
                "dqsl": "9.6",
                "dqwd": "6.5",
                "gzbj": 0,
                "lcdl": "47.6",
                "lcdy": "34.7",
                "scdl": "57.6",
                "scdy": "11.6",
                "slcsl": "5.2",
                "slcwd": "5.5",
                "sn": 0,
                "sxwd": "2.3",
                "xlcsl": "4.8",
                "xlcwd": "5.5",
                "yxsj": "0天 0小时 23分钟 40秒"
            },
            "update_time": "2024-05-19 16:20:31"
        }
    ],
    "page_size": 10,
    "total": 3615
};
export function jsonToTableData(jsonList, keys, names) {
    const dataSource = [];
    const column = [];

    for (let i = 0; i < keys.length; i++) {
        column.push({
            title: names[i],
            dataIndex: keys[i],
            key: keys[i],
            align: 'center',
        });
    }
    // 添加tag
    column.push({
        title: '状态',
        dataIndex: 'status',
        key: 'status',
        align: 'center',
        render: (_, { status }) => (
            <>
                {status.map((tag) => {
                    if (tag === '正常') {
                        return (
                            <Tag color="green" key={tag}>
                                {tag.toUpperCase()}
                            </Tag>
                        );
                    }else if(tag.includes('低')) {
                        return (
                            <Tag color="blue" key={tag}>
                                {tag.toUpperCase()}
                            </Tag>
                        );
                    }else{
                        return (
                            <Tag color="red" key={tag}>
                                {tag.toUpperCase()}
                            </Tag>
                        );
                    }
                })}
            </>
        ),
    });
    column.push({
        title: '时间',
        dataIndex: 'update_time',
        key: 'update_time',
        align: 'center',
    });
    const alarm_rules = jsonList['alarm_rules'];
    for (const json of jsonList['data_history']) {
        let dataChild = {};
        const update_time = json.update_time;
        const data = json.data;
        dataChild['status'] = ['正常'];
        for (const key of keys) {
            dataChild[key] = data[key];
            if(key==="sn"||key==="gzbj"){
                if(data[key]===1) {
                    dataChild['status'] = ['异常'];
                }
            }else if ((alarm_rules[key][0] !== -1 && data[key] < alarm_rules[key][0])||(alarm_rules[key][1] !== -1 && data[key] > alarm_rules[key][1])) {
                if(dataChild['status'][0] === '正常'){
                    dataChild['status'] = [];
                }
                if(data[key] < alarm_rules[key][0]){
                    dataChild['status'].push(`${keyMap[key]} 过低`);
                }else{
                    dataChild['status'].push(`${keyMap[key]} 过高`);
                }
            }

        }
        dataChild['update_time'] = update_time;
        dataSource.push(dataChild);
    }
    return {
        'dataSource': dataSource,
        'column': column,
        'total': jsonList.total,
    };
}

// console.log(jsonToTableData(data,['scdl','scdy'],['输出电流','输出电压']));